// ../browser-message-broker/dist/Broker.js
var h = "broadcast-sync";
var g = "browser-message-broker";
function p(a) {
  return a.subsKey === h;
}
function b(a) {
  return a.senderId != null && a.targetId == null;
}
function f(a) {
  return a.senderId != null && a.targetId != null;
}
var c = Math.random().toString(36).substring(2, 9);
function w(a, e = 1) {
  let s;
  return (...t) => {
    clearTimeout(s), s = setTimeout(() => {
      a(...t);
    }, e);
  };
}
var l = class {
  constructor() {
    this.trace = false;
    this.senderId = c;
    this.state = /* @__PURE__ */ new Map();
    this.subscribers = /* @__PURE__ */ new Map();
    this.braodcasts = /* @__PURE__ */ new Set();
    this.__bcChannel = new BroadcastChannel(g);
    this.__nextMessageAwaters = /* @__PURE__ */ new Map();
    this.broadcastedRequests = /* @__PURE__ */ new Map();
    this.requestListeners = /* @__PURE__ */ new Map();
    if (globalThis.constructor.name === "Window") {
      let e = new CustomEvent("bmb-ready", { detail: this });
      globalThis.document.dispatchEvent(e);
    }
    this.__bcChannel.onmessage = this.handleBroadcast.bind(this), this.__bcChannel.onmessageerror = this.handleBroadcastError.bind(this), this.sendBrokerState = w(this.__sendBrokerState.bind(this), 2), this.sendBrokerState();
  }
  handleBroadcastError(e) {
    throw Error("BROADCAST FAILED: " + e.data);
  }
  __sendBrokerState(e, s) {
    let t = Array.from(this.braodcasts.keys());
    s && s.length > 0 && (t = t.filter((o) => s.includes(o)));
    let n = {};
    for (let o of this.state)
      !o[1] || !t.includes(o[0]) || (n[o[0]] = o[1]);
    let r = { id: c, availableState: n, broadcasts: t }, i = { subsKey: h, senderCtx: globalThis.constructor.name, senderId: c, targetId: e, msg: r, channelType: "sync" };
    this.__bcChannel.postMessage(i), this.trace && (e == null ? console.log("[Broadcast sync requested]", i, this) : console.log("[Broadcast sync responded]", e, i, this));
  }
  handleBroadcastSync(e) {
    if (b(e))
      return this.sendBrokerState(e.senderId, e.msg.broadcasts);
    if (f(e))
      for (let s of Object.entries(e.msg.availableState))
        this.braodcasts.has(s[0]) && this.state.has(s[0]) && this.state.get(s[0]) == null && this.__notifySubscribers(s[0], s[1], e.senderId), this.trace && console.log("[Broadcast sync responce handled]", e, this);
  }
  handleBroadcast(e) {
    if (this.trace && console.log("[Broadcast received]", e.data, this), e.data.targetId != null && e.data.targetId !== c) {
      this.trace && console.log("[Broadcast ignored]", e.data, this);
      return;
    }
    if (p(e.data))
      return this.handleBroadcastSync(e.data);
    switch (e.data.channelType) {
      case "pubSub":
        this.__notifySubscribers(e.data.subsKey, e.data.msg, e.data.senderId);
        break;
      case "req":
        this.bridgeRequest(e.data.subsKey, e.data.msg, e.data.senderId);
        break;
      case "rep":
        let s = this.broadcastedRequests.get(e.data.subsKey);
        if (!s)
          return;
        s.resolve(e.data.msg), this.broadcastedRequests.delete(e.data.subsKey);
        break;
    }
    this.trace && console.log("[Broadcast handled]", e.data, this);
  }
  __configureBroadcast(e) {
    if (!e.key)
      throw new Error("Invalid subscription");
    this.braodcasts.add(e.key);
    let s = e.dispose;
    e.dispose = () => {
      s(), this.braodcasts.delete(e.key);
    }, e.isBroadcast = true, this.sendBrokerState();
  }
  GetState(e) {
    if (e)
      return this.state.get(e);
  }
  async Broadcast(e, s, t) {
    this._broadcast(e, s, "pubSub", t);
  }
  _broadcast(e, s, t, n) {
    this.trace && console.log("[Message broadcasted]", e, s, this);
    let r = { subsKey: e, senderCtx: globalThis.constructor.name, senderId: c, targetId: n, msg: s, channelType: t };
    this.__bcChannel.postMessage(r);
  }
  async Publish(e, s, t) {
    this.trace && console.log("[Message published]", e, s, this), await this.__notifySubscribers(e, s, c), this.braodcasts.has(e) && this._broadcast(e, s, "pubSub", t);
  }
  async nextMessage(e) {
    let s = this.__nextMessageAwaters.get(e);
    if (s)
      return s.promise;
    let t = { promise: void 0, resolve: void 0 };
    return t.promise = new Promise((n) => {
      t.resolve = n;
    }), this.__nextMessageAwaters.set(e, t), t.promise;
  }
  Subscribe(e, s, t = false, n = true) {
    let r = this.subscribers.get(e) || [], i = s;
    r.push(i), this.subscribers.set(e, r);
    let o = { key: e, isCached: false, dispose: () => {
      r.splice(r.indexOf(i), 1), o.isDisposed = true;
    }, publish: (d, u) => this.Publish(e, d, u), isDisposed: false };
    return t && this.__configureBroadcast(o), n && this.state.set(e, void 0), this.trace && console.log("[Subscribe]", o, this), o;
  }
  bridgeRequest(e, s, t) {
    let n = this.requestListeners.get(e);
    return n ? n.handler(s, t) : Promise.resolve(void 0);
  }
  Request(e, s, t = false, n) {
    if (t) {
      this._broadcast(e, s, "req", n);
      let r = this.broadcastedRequests.get(e);
      r && r.resolve(void 0);
      let i, d = { promise: new Promise((u) => i = u), resolve: i };
      return this.broadcastedRequests.set(e, d), d.promise;
    } else {
      let r = this.requestListeners.get(e);
      return r ? r.handler(s) : Promise.resolve(void 0);
    }
  }
  Reply(e, s, t = false) {
    if (t) {
      let i = s;
      s = (o, d) => this._broadcast(e, i(o), "rep", d);
    }
    let n = { channelName: e, isDisposed: true, isBroadcast: t, handler: s, dispose: void 0 };
    n.dispose = () => {
      n.isDisposed = true, this.requestListeners.get(e) === n && this.requestListeners.delete(e);
    };
    let r = this.requestListeners.get(e);
    return r && (r.isDisposed = true, console.warn("Request listener replaced: " + e)), this.requestListeners.set(e, n), n;
  }
  async __notifySubscribers(e, s, t) {
    let n = this.subscribers.get(e) || [], r = [];
    for (let i of n)
      !i || (r.push(Promise.resolve(i(s, t))), this.trace && console.log("[Handler called]", i, this));
    await Promise.all(r), this.state.has(e) && this.state.set(e, s), this.__handleAwaiter(e, s), this.trace && console.log("[Message handled]", e, s, this);
  }
  __handleAwaiter(e, s) {
    let t = this.__nextMessageAwaters.get(e);
    !t || (t.resolve(s), this.__nextMessageAwaters.delete(e));
  }
};
globalThis.BrowserMessageBroker = globalThis.BrowserMessageBroker || new l();
var B = globalThis.BrowserMessageBroker;

// suite/WebWorker/constants.ts
var PUB_SUB_REQUEST_SUBSCRIPTION_KEY = "testReq";
var PUB_SUB_RESPONSE_SUBSCRIPTION_KEY = "testResp";
var REQ_REP_CHANNEL_NAME = "reqRepChannel";

// suite/WebWorker/testWorker.ts
var pubSubChannelToWindow = B.Subscribe(PUB_SUB_RESPONSE_SUBSCRIPTION_KEY, void 0, true);
B.Subscribe(PUB_SUB_REQUEST_SUBSCRIPTION_KEY, (_) => {
  pubSubChannelToWindow.publish({ payload: "response" });
}, true);
B.Reply(REQ_REP_CHANNEL_NAME, (req) => {
  return { payload: req.payload + "response" };
}, true);
postMessage("ready");
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vYnJvd3Nlci1tZXNzYWdlLWJyb2tlci9zcmMvQnJva2VyLnRzIiwgImNvbnN0YW50cy50cyIsICJ0ZXN0V29ya2VyLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge1xyXG4gIENoYW5uZWxUeXBlLFxyXG4gIElCcm9hZGNhc3RFbnZlbG9wZSxcclxuICBJQnJvYWRjYXN0U3luY0VudmVsb3BlLFxyXG4gIElCcm9rZXIsXHJcbiAgSUJyb2tlclN0YXRlLFxyXG4gIFJlcVN1YnNjcmlwdGlvbixcclxuICBTdWJzY3JpcHRpb24sXHJcbiAgVEhhbmRsZXIsXHJcbn0gZnJvbSBcIi4vVHlwZXNcIjtcclxuXHJcbmNvbnN0IEJST0FEQ0FTVF9TWU5DID0gXCJicm9hZGNhc3Qtc3luY1wiO1xyXG5jb25zdCBCUk9XU0VSX01FU1NBR0VfQlJPS0VSID0gXCJicm93c2VyLW1lc3NhZ2UtYnJva2VyXCI7XHJcblxyXG5mdW5jdGlvbiBpc0Jyb2FkY2FzdFN5bmMoZTogSUJyb2FkY2FzdEVudmVsb3BlKTogZSBpcyBJQnJvYWRjYXN0U3luY0VudmVsb3BlIHtcclxuICByZXR1cm4gZS5zdWJzS2V5ID09PSBCUk9BRENBU1RfU1lOQztcclxufVxyXG5cclxuZnVuY3Rpb24gaXNTeW5jUmVxKGU6IElCcm9hZGNhc3RFbnZlbG9wZSkge1xyXG4gIHJldHVybiBlLnNlbmRlcklkICE9IHVuZGVmaW5lZCAmJiBlLnRhcmdldElkID09IHVuZGVmaW5lZDtcclxufVxyXG5mdW5jdGlvbiBpc1N5bmNSZXNwKGU6IElCcm9hZGNhc3RFbnZlbG9wZSkge1xyXG4gIHJldHVybiBlLnNlbmRlcklkICE9IHVuZGVmaW5lZCAmJiBlLnRhcmdldElkICE9IHVuZGVmaW5lZDtcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IHNlbmRlcklkID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIsIDkpO1xyXG5cclxuZnVuY3Rpb24gZGVib3VuY2U8VCBleHRlbmRzIEZ1bmN0aW9uPihmdW5jOiBULCB0aW1lb3V0ID0gMSkge1xyXG4gIGxldCB0aW1lcjogbnVtYmVyO1xyXG4gIHJldHVybiAoLi4uYXJnczogdW5rbm93bltdKSA9PiB7XHJcbiAgICBjbGVhclRpbWVvdXQodGltZXIpO1xyXG4gICAgdGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcclxuICAgICAgZnVuYyguLi5hcmdzKTtcclxuICAgIH0sIHRpbWVvdXQpO1xyXG4gIH07XHJcbn1cclxuXHJcbmNsYXNzIEJyb2tlciBpbXBsZW1lbnRzIElCcm9rZXIge1xyXG4gIHRyYWNlOiBib29sZWFuID0gZmFsc2U7XHJcbiAgc2VuZGVySWQgPSBzZW5kZXJJZDtcclxuICBzdGF0ZSA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KCk7XHJcbiAgc3Vic2NyaWJlcnMgPSBuZXcgTWFwPHN0cmluZywgVEhhbmRsZXJbXT4oKTtcclxuICBicmFvZGNhc3RzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgcHJpdmF0ZSBfX2JjQ2hhbm5lbCA9IG5ldyBCcm9hZGNhc3RDaGFubmVsKEJST1dTRVJfTUVTU0FHRV9CUk9LRVIpO1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIGlmIChnbG9iYWxUaGlzLmNvbnN0cnVjdG9yLm5hbWUgPT09IFwiV2luZG93XCIpIHtcclxuICAgICAgY29uc3QgZXYgPSBuZXcgQ3VzdG9tRXZlbnQoXCJibWItcmVhZHlcIiwgeyBkZXRhaWw6IHRoaXMgfSk7XHJcbiAgICAgIGdsb2JhbFRoaXMuZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChldik7XHJcbiAgICB9XHJcbiAgICB0aGlzLl9fYmNDaGFubmVsLm9ubWVzc2FnZSA9IHRoaXMuaGFuZGxlQnJvYWRjYXN0LmJpbmQodGhpcyk7XHJcbiAgICB0aGlzLl9fYmNDaGFubmVsLm9ubWVzc2FnZWVycm9yID0gdGhpcy5oYW5kbGVCcm9hZGNhc3RFcnJvci5iaW5kKHRoaXMpO1xyXG5cclxuICAgIHRoaXMuc2VuZEJyb2tlclN0YXRlID0gZGVib3VuY2UodGhpcy5fX3NlbmRCcm9rZXJTdGF0ZS5iaW5kKHRoaXMpLCAyKTtcclxuXHJcbiAgICB0aGlzLnNlbmRCcm9rZXJTdGF0ZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBoYW5kbGVCcm9hZGNhc3RFcnJvcihldjogTWVzc2FnZUV2ZW50PElCcm9hZGNhc3RFbnZlbG9wZT4pIHtcclxuICAgIHRocm93IEVycm9yKFwiQlJPQURDQVNUIEZBSUxFRDogXCIgKyBldi5kYXRhKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgc2VuZEJyb2tlclN0YXRlOiAoXHJcbiAgICB0YXJnZXRJZD86IHN0cmluZyxcclxuICAgIGZpbHRlckJyb2FkY2FzdHM/OiBzdHJpbmdbXVxyXG4gICkgPT4gdm9pZDtcclxuICBwcml2YXRlIF9fc2VuZEJyb2tlclN0YXRlKHRhcmdldElkPzogc3RyaW5nLCBmaWx0ZXJCcm9hZGNhc3RzPzogc3RyaW5nW10pIHtcclxuICAgIGxldCBjdXJyZW50QnJvYWRjYXN0cyA9IEFycmF5LmZyb20odGhpcy5icmFvZGNhc3RzLmtleXMoKSk7XHJcblxyXG4gICAgaWYgKGZpbHRlckJyb2FkY2FzdHMgJiYgZmlsdGVyQnJvYWRjYXN0cy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGN1cnJlbnRCcm9hZGNhc3RzID0gY3VycmVudEJyb2FkY2FzdHMuZmlsdGVyKChrKSA9PlxyXG4gICAgICAgIGZpbHRlckJyb2FkY2FzdHMuaW5jbHVkZXMoaylcclxuICAgICAgKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhdmFpbGFibGVTdGF0ZTogeyBbeDogc3RyaW5nXTogYW55IH0gPSB7fTtcclxuICAgIGZvciAoY29uc3QgeCBvZiB0aGlzLnN0YXRlKSB7XHJcbiAgICAgIGlmICgheFsxXSkgY29udGludWU7XHJcbiAgICAgIGlmICghY3VycmVudEJyb2FkY2FzdHMuaW5jbHVkZXMoeFswXSkpIGNvbnRpbnVlO1xyXG4gICAgICBhdmFpbGFibGVTdGF0ZVt4WzBdXSA9IHhbMV07XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3RhdGU6IElCcm9rZXJTdGF0ZSA9IHtcclxuICAgICAgaWQ6IHNlbmRlcklkLFxyXG4gICAgICBhdmFpbGFibGVTdGF0ZSxcclxuICAgICAgYnJvYWRjYXN0czogY3VycmVudEJyb2FkY2FzdHMsXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGV2OiBJQnJvYWRjYXN0U3luY0VudmVsb3BlID0ge1xyXG4gICAgICBzdWJzS2V5OiBCUk9BRENBU1RfU1lOQyxcclxuICAgICAgc2VuZGVyQ3R4OiBnbG9iYWxUaGlzLmNvbnN0cnVjdG9yLm5hbWUsXHJcbiAgICAgIHNlbmRlcklkLFxyXG4gICAgICB0YXJnZXRJZCxcclxuICAgICAgbXNnOiBzdGF0ZSxcclxuICAgICAgY2hhbm5lbFR5cGU6IFwic3luY1wiLFxyXG4gICAgfTtcclxuXHJcbiAgICB0aGlzLl9fYmNDaGFubmVsLnBvc3RNZXNzYWdlKGV2KTtcclxuXHJcbiAgICBpZiAodGhpcy50cmFjZSlcclxuICAgICAgaWYgKHRhcmdldElkID09IHVuZGVmaW5lZClcclxuICAgICAgICBjb25zb2xlLmxvZyhcIltCcm9hZGNhc3Qgc3luYyByZXF1ZXN0ZWRdXCIsIGV2LCB0aGlzKTtcclxuICAgICAgZWxzZSBjb25zb2xlLmxvZyhcIltCcm9hZGNhc3Qgc3luYyByZXNwb25kZWRdXCIsIHRhcmdldElkLCBldiwgdGhpcyk7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhbmRsZUJyb2FkY2FzdFN5bmMoZXY6IElCcm9hZGNhc3RTeW5jRW52ZWxvcGUpIHtcclxuICAgIGlmIChpc1N5bmNSZXEoZXYpKVxyXG4gICAgICByZXR1cm4gdGhpcy5zZW5kQnJva2VyU3RhdGUoZXYuc2VuZGVySWQsIGV2Lm1zZy5icm9hZGNhc3RzKTtcclxuICAgIGlmIChpc1N5bmNSZXNwKGV2KSkge1xyXG4gICAgICBmb3IgKGNvbnN0IHMgb2YgT2JqZWN0LmVudHJpZXMoZXYubXNnLmF2YWlsYWJsZVN0YXRlKSkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIHRoaXMuYnJhb2RjYXN0cy5oYXMoc1swXSkgJiZcclxuICAgICAgICAgIHRoaXMuc3RhdGUuaGFzKHNbMF0pICYmXHJcbiAgICAgICAgICB0aGlzLnN0YXRlLmdldChzWzBdKSA9PSB1bmRlZmluZWRcclxuICAgICAgICApIHtcclxuICAgICAgICAgIHRoaXMuX19ub3RpZnlTdWJzY3JpYmVycyhzWzBdLCBzWzFdLCBldi5zZW5kZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLnRyYWNlKVxyXG4gICAgICAgICAgY29uc29sZS5sb2coXCJbQnJvYWRjYXN0IHN5bmMgcmVzcG9uY2UgaGFuZGxlZF1cIiwgZXYsIHRoaXMpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGhhbmRsZUJyb2FkY2FzdChldjogTWVzc2FnZUV2ZW50PElCcm9hZGNhc3RFbnZlbG9wZT4pIHtcclxuICAgIGlmICh0aGlzLnRyYWNlKSBjb25zb2xlLmxvZyhcIltCcm9hZGNhc3QgcmVjZWl2ZWRdXCIsIGV2LmRhdGEsIHRoaXMpO1xyXG5cclxuICAgIGlmIChldi5kYXRhLnRhcmdldElkICE9IHVuZGVmaW5lZCAmJiBldi5kYXRhLnRhcmdldElkICE9PSBzZW5kZXJJZCkge1xyXG4gICAgICBpZiAodGhpcy50cmFjZSkgY29uc29sZS5sb2coXCJbQnJvYWRjYXN0IGlnbm9yZWRdXCIsIGV2LmRhdGEsIHRoaXMpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKGlzQnJvYWRjYXN0U3luYyhldi5kYXRhKSkgcmV0dXJuIHRoaXMuaGFuZGxlQnJvYWRjYXN0U3luYyhldi5kYXRhKTtcclxuXHJcbiAgICBzd2l0Y2ggKGV2LmRhdGEuY2hhbm5lbFR5cGUpIHtcclxuICAgICAgY2FzZSBcInB1YlN1YlwiOlxyXG4gICAgICAgIHRoaXMuX19ub3RpZnlTdWJzY3JpYmVycyhcclxuICAgICAgICAgIGV2LmRhdGEuc3Vic0tleSxcclxuICAgICAgICAgIGV2LmRhdGEubXNnLFxyXG4gICAgICAgICAgZXYuZGF0YS5zZW5kZXJJZFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJyZXFcIjpcclxuICAgICAgICB0aGlzLmJyaWRnZVJlcXVlc3QoZXYuZGF0YS5zdWJzS2V5LCBldi5kYXRhLm1zZywgZXYuZGF0YS5zZW5kZXJJZCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJyZXBcIjpcclxuICAgICAgICBjb25zdCByZXEgPSB0aGlzLmJyb2FkY2FzdGVkUmVxdWVzdHMuZ2V0KGV2LmRhdGEuc3Vic0tleSk7XHJcbiAgICAgICAgaWYgKCFyZXEpIHJldHVybjtcclxuXHJcbiAgICAgICAgcmVxLnJlc29sdmUoZXYuZGF0YS5tc2cpO1xyXG4gICAgICAgIHRoaXMuYnJvYWRjYXN0ZWRSZXF1ZXN0cy5kZWxldGUoZXYuZGF0YS5zdWJzS2V5KTtcclxuXHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMudHJhY2UpIGNvbnNvbGUubG9nKFwiW0Jyb2FkY2FzdCBoYW5kbGVkXVwiLCBldi5kYXRhLCB0aGlzKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEJyaWRnZSBwdWIvc3ViIG1lc3NhZ2VzIHRvIGJyb2FkY2FzdCBjaGFubmVsXHJcbiAgICogQHBhcmFtIHN1YnNLZXlcclxuICAgKiBAcmV0dXJucyB7U3Vic2NyaXB0aW9ufVxyXG4gICAqL1xyXG4gIHByaXZhdGUgX19jb25maWd1cmVCcm9hZGNhc3Qoc3Vic2NyaXB0aW9uOiBTdWJzY3JpcHRpb248YW55Pik6IHZvaWQge1xyXG4gICAgaWYgKCFzdWJzY3JpcHRpb24ua2V5KSB7XHJcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBzdWJzY3JpcHRpb25gKTtcclxuICAgIH1cclxuICAgIHRoaXMuYnJhb2RjYXN0cy5hZGQoc3Vic2NyaXB0aW9uLmtleSk7XHJcbiAgICBjb25zdCBvcmlnaW5hbERpc3Bvc2UgPSBzdWJzY3JpcHRpb24uZGlzcG9zZTtcclxuICAgIHN1YnNjcmlwdGlvbi5kaXNwb3NlID0gKCkgPT4ge1xyXG4gICAgICBvcmlnaW5hbERpc3Bvc2UoKTtcclxuICAgICAgdGhpcy5icmFvZGNhc3RzLmRlbGV0ZShzdWJzY3JpcHRpb24ua2V5KTtcclxuICAgIH07XHJcbiAgICBzdWJzY3JpcHRpb24uaXNCcm9hZGNhc3QgPSB0cnVlO1xyXG5cclxuICAgIHRoaXMuc2VuZEJyb2tlclN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBHZXRTdGF0ZTxUPihzdWJzS2V5OiBzdHJpbmcpOiBUIHwgdW5kZWZpbmVkIHtcclxuICAgIGlmIChzdWJzS2V5KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLnN0YXRlLmdldChzdWJzS2V5KSBhcyBUO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGFzeW5jIEJyb2FkY2FzdChzdWJzS2V5OiBzdHJpbmcsIG1zZzogdW5rbm93biwgdGFyZ2V0SWQ/OiBzdHJpbmcpIHtcclxuICAgIHRoaXMuX2Jyb2FkY2FzdChzdWJzS2V5LCBtc2csIFwicHViU3ViXCIsIHRhcmdldElkKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX2Jyb2FkY2FzdChcclxuICAgIHN1YnNLZXk6IHN0cmluZyxcclxuICAgIG1zZzogdW5rbm93bixcclxuICAgIGNoYW5uZWxUeXBlOiBDaGFubmVsVHlwZSxcclxuICAgIHRhcmdldElkPzogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICBpZiAodGhpcy50cmFjZSkgY29uc29sZS5sb2coXCJbTWVzc2FnZSBicm9hZGNhc3RlZF1cIiwgc3Vic0tleSwgbXNnLCB0aGlzKTtcclxuXHJcbiAgICBjb25zdCBlbnZlbG9wZTogSUJyb2FkY2FzdEVudmVsb3BlID0ge1xyXG4gICAgICBzdWJzS2V5LFxyXG4gICAgICBzZW5kZXJDdHg6IGdsb2JhbFRoaXMuY29uc3RydWN0b3IubmFtZSxcclxuICAgICAgc2VuZGVySWQ6IHNlbmRlcklkLFxyXG4gICAgICB0YXJnZXRJZDogdGFyZ2V0SWQsXHJcbiAgICAgIG1zZyxcclxuICAgICAgY2hhbm5lbFR5cGUsXHJcbiAgICB9O1xyXG4gICAgdGhpcy5fX2JjQ2hhbm5lbC5wb3N0TWVzc2FnZShlbnZlbG9wZSk7XHJcbiAgfVxyXG5cclxuICBhc3luYyBQdWJsaXNoKHN1YnNLZXk6IHN0cmluZywgbXNnOiB1bmtub3duLCB0YXJnZXRJZD86IHN0cmluZykge1xyXG4gICAgaWYgKHRoaXMudHJhY2UpIGNvbnNvbGUubG9nKFwiW01lc3NhZ2UgcHVibGlzaGVkXVwiLCBzdWJzS2V5LCBtc2csIHRoaXMpO1xyXG4gICAgYXdhaXQgdGhpcy5fX25vdGlmeVN1YnNjcmliZXJzKHN1YnNLZXksIG1zZywgc2VuZGVySWQpO1xyXG5cclxuICAgIGlmICghdGhpcy5icmFvZGNhc3RzLmhhcyhzdWJzS2V5KSkgcmV0dXJuO1xyXG5cclxuICAgIHRoaXMuX2Jyb2FkY2FzdChzdWJzS2V5LCBtc2csIFwicHViU3ViXCIsIHRhcmdldElkKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgX19uZXh0TWVzc2FnZUF3YXRlcnMgPSBuZXcgTWFwPFxyXG4gICAgc3RyaW5nLFxyXG4gICAgeyBwcm9taXNlOiBQcm9taXNlPHVua25vd24+OyByZXNvbHZlOiAobXNnOiB1bmtub3duKSA9PiB1bmtub3duIH1cclxuICA+KCk7XHJcblxyXG4gIGFzeW5jIG5leHRNZXNzYWdlPFQgPSB1bmtub3duPihzdWJzS2V5OiBzdHJpbmcpOiBQcm9taXNlPFQ+IHtcclxuICAgIGNvbnN0IGEgPSB0aGlzLl9fbmV4dE1lc3NhZ2VBd2F0ZXJzLmdldChzdWJzS2V5KTtcclxuICAgIGlmIChhKSByZXR1cm4gYS5wcm9taXNlIGFzIFByb21pc2U8VD47XHJcblxyXG4gICAgY29uc3QgbmV3QXdhaXRlcjoge1xyXG4gICAgICBwcm9taXNlOiBQcm9taXNlPHVua25vd24+O1xyXG4gICAgICByZXNvbHZlOiAobXNnOiB1bmtub3duKSA9PiB2b2lkO1xyXG4gICAgfSA9IHtcclxuICAgICAgcHJvbWlzZTogdW5kZWZpbmVkIGFzIHVua25vd24gYXMgUHJvbWlzZTxUPixcclxuICAgICAgcmVzb2x2ZTogdW5kZWZpbmVkIGFzIHVua25vd24gYXMgKG1zZzogdW5rbm93bikgPT4gdm9pZCxcclxuICAgIH07XHJcbiAgICBuZXdBd2FpdGVyLnByb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzOiAobXNnOiB1bmtub3duKSA9PiB2b2lkKSA9PiB7XHJcbiAgICAgIG5ld0F3YWl0ZXIucmVzb2x2ZSA9IHJlcztcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMuX19uZXh0TWVzc2FnZUF3YXRlcnMuc2V0KHN1YnNLZXksIG5ld0F3YWl0ZXIpO1xyXG5cclxuICAgIHJldHVybiBuZXdBd2FpdGVyLnByb21pc2UgYXMgUHJvbWlzZTxUPjtcclxuICB9XHJcblxyXG4gIFN1YnNjcmliZTxUPihcclxuICAgIGtleTogc3RyaW5nLFxyXG4gICAgaGFuZGxlcj86IFRIYW5kbGVyPFQ+LFxyXG4gICAgZW5hYmxlQnJvYWRjYXN0ID0gZmFsc2UsXHJcbiAgICBlbmFibGVDYWNoaW5nID0gdHJ1ZVxyXG4gICk6IFN1YnNjcmlwdGlvbjxUPiB7XHJcbiAgICBjb25zdCBzdWJzID0gdGhpcy5zdWJzY3JpYmVycy5nZXQoa2V5KSB8fCBbXTtcclxuICAgIGNvbnN0IGhkbCA9IGhhbmRsZXIgYXMgKG1zZzogdW5rbm93bikgPT4gdm9pZDtcclxuICAgIHN1YnMucHVzaChoZGwpO1xyXG4gICAgdGhpcy5zdWJzY3JpYmVycy5zZXQoa2V5LCBzdWJzKTtcclxuXHJcbiAgICBjb25zdCBzdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbjxUPiA9IHtcclxuICAgICAga2V5OiBrZXksXHJcbiAgICAgIGlzQ2FjaGVkOiBmYWxzZSxcclxuICAgICAgZGlzcG9zZTogKCkgPT4ge1xyXG4gICAgICAgIHN1YnMuc3BsaWNlKHN1YnMuaW5kZXhPZihoZGwpLCAxKTtcclxuICAgICAgICBzdWJzY3JpcHRpb24uaXNEaXNwb3NlZCA9IHRydWU7XHJcbiAgICAgIH0sXHJcbiAgICAgIHB1Ymxpc2g6IChtc2csIHRhcmdldElkPzogc3RyaW5nKSA9PiB0aGlzLlB1Ymxpc2goa2V5LCBtc2csIHRhcmdldElkKSxcclxuICAgICAgaXNEaXNwb3NlZDogZmFsc2UsXHJcbiAgICB9O1xyXG5cclxuICAgIGlmIChlbmFibGVCcm9hZGNhc3QpIHRoaXMuX19jb25maWd1cmVCcm9hZGNhc3Qoc3Vic2NyaXB0aW9uKTtcclxuICAgIGlmIChlbmFibGVDYWNoaW5nKSB0aGlzLnN0YXRlLnNldChrZXksIHVuZGVmaW5lZCk7XHJcblxyXG4gICAgaWYgKHRoaXMudHJhY2UpIGNvbnNvbGUubG9nKFwiW1N1YnNjcmliZV1cIiwgc3Vic2NyaXB0aW9uLCB0aGlzKTtcclxuICAgIHJldHVybiBzdWJzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIGJyaWRnZVJlcXVlc3QoXHJcbiAgICBjaGFubmVsTmFtZTogc3RyaW5nLFxyXG4gICAgcmVxdWVzdERhdGE6IHVua25vd24sXHJcbiAgICBzZW5kZXJJZDogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICBjb25zdCBsaXN0ZW5lciA9IHRoaXMucmVxdWVzdExpc3RlbmVycy5nZXQoY2hhbm5lbE5hbWUpO1xyXG4gICAgaWYgKCFsaXN0ZW5lcikgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpO1xyXG4gICAgcmV0dXJuIGxpc3RlbmVyLmhhbmRsZXIocmVxdWVzdERhdGEsIHNlbmRlcklkKSBhcyBQcm9taXNlPHVua25vd24+O1xyXG4gIH1cclxuXHJcbiAgUmVxdWVzdDxUUmVwID0gdW5rbm93bj4oXHJcbiAgICBjaGFubmVsTmFtZTogc3RyaW5nLFxyXG4gICAgcmVxdWVzdERhdGE6IHVua25vd24sXHJcbiAgICBlbmFibGVCcm9hZGNhc3QgPSBmYWxzZSxcclxuICAgIHRhcmdldElkPzogc3RyaW5nXHJcbiAgKTogUHJvbWlzZTxUUmVwPiB8IFByb21pc2U8dW5kZWZpbmVkPiB7XHJcbiAgICBpZiAoIWVuYWJsZUJyb2FkY2FzdCkge1xyXG4gICAgICBjb25zdCBsaXN0ZW5lciA9IHRoaXMucmVxdWVzdExpc3RlbmVycy5nZXQoY2hhbm5lbE5hbWUpO1xyXG4gICAgICBpZiAoIWxpc3RlbmVyKSByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCk7XHJcbiAgICAgIHJldHVybiBsaXN0ZW5lci5oYW5kbGVyKHJlcXVlc3REYXRhKSBhcyBQcm9taXNlPFRSZXA+O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnJvYWRjYXN0KGNoYW5uZWxOYW1lLCByZXF1ZXN0RGF0YSwgXCJyZXFcIiwgdGFyZ2V0SWQpO1xyXG4gICAgICBjb25zdCByZXEgPSB0aGlzLmJyb2FkY2FzdGVkUmVxdWVzdHMuZ2V0KGNoYW5uZWxOYW1lKTtcclxuICAgICAgaWYgKHJlcSkgcmVxLnJlc29sdmUodW5kZWZpbmVkKTtcclxuXHJcbiAgICAgIGxldCByZXNvbHZlID0gdW5kZWZpbmVkIGFzIHVua25vd24gYXMgKHI6IHVua25vd24pID0+IHZvaWQ7XHJcbiAgICAgIGNvbnN0IHByb21pc2UgPSBuZXcgUHJvbWlzZTxUUmVwPihcclxuICAgICAgICAocmVzKSA9PiAocmVzb2x2ZSA9IHJlcyBhcyAocjogdW5rbm93bikgPT4gdm9pZClcclxuICAgICAgKTtcclxuICAgICAgY29uc3QgYnJlcSA9IHtcclxuICAgICAgICBwcm9taXNlLFxyXG4gICAgICAgIHJlc29sdmUsXHJcbiAgICAgIH07XHJcbiAgICAgIHRoaXMuYnJvYWRjYXN0ZWRSZXF1ZXN0cy5zZXQoY2hhbm5lbE5hbWUsIGJyZXEpO1xyXG4gICAgICByZXR1cm4gYnJlcS5wcm9taXNlO1xyXG4gICAgfVxyXG4gIH1cclxuICBwcml2YXRlIGJyb2FkY2FzdGVkUmVxdWVzdHMgPSBuZXcgTWFwPFxyXG4gICAgc3RyaW5nLFxyXG4gICAgeyBwcm9taXNlOiBQcm9taXNlPHVua25vd24+OyByZXNvbHZlOiAocjogdW5rbm93bikgPT4gdm9pZCB9XHJcbiAgPigpO1xyXG5cclxuICBSZXBseTxUUmVxID0gdW5rbm93biwgVFJlcCA9IHVua25vd24+KFxyXG4gICAgY2hhbm5lbE5hbWU6IHN0cmluZyxcclxuICAgIGhhbmRsZXI6IChyZXE6IFRSZXEpID0+IFRSZXAsXHJcbiAgICBlbmFibGVCcm9hZGNhc3QgPSBmYWxzZVxyXG4gICkge1xyXG4gICAgaWYgKGVuYWJsZUJyb2FkY2FzdCkge1xyXG4gICAgICBjb25zdCBvcmlnSGFuZGxlciA9IGhhbmRsZXI7XHJcbiAgICAgIGhhbmRsZXIgPSAoKG1zZzogVFJlcSwgdGFyZ2V0SWQ6IHN0cmluZykgPT5cclxuICAgICAgICB0aGlzLl9icm9hZGNhc3QoXHJcbiAgICAgICAgICBjaGFubmVsTmFtZSxcclxuICAgICAgICAgIG9yaWdIYW5kbGVyKG1zZyksXHJcbiAgICAgICAgICBcInJlcFwiLFxyXG4gICAgICAgICAgdGFyZ2V0SWRcclxuICAgICAgICApKSBhcyB1bmtub3duIGFzIChyZXE6IFRSZXEpID0+IFRSZXA7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3ViczogUmVxU3Vic2NyaXB0aW9uID0ge1xyXG4gICAgICBjaGFubmVsTmFtZSxcclxuICAgICAgaXNEaXNwb3NlZDogdHJ1ZSxcclxuICAgICAgaXNCcm9hZGNhc3Q6IGVuYWJsZUJyb2FkY2FzdCxcclxuICAgICAgaGFuZGxlcjogaGFuZGxlciBhcyAocjogdW5rbm93bikgPT4gdW5rbm93bixcclxuICAgICAgZGlzcG9zZTogdW5kZWZpbmVkIGFzIHVua25vd24gYXMgKCkgPT4gdm9pZCxcclxuICAgIH07XHJcblxyXG4gICAgc3Vicy5kaXNwb3NlID0gKCkgPT4ge1xyXG4gICAgICBzdWJzLmlzRGlzcG9zZWQgPSB0cnVlO1xyXG4gICAgICBjb25zdCBjdXJyZW50TGlzdGVuZXIgPSB0aGlzLnJlcXVlc3RMaXN0ZW5lcnMuZ2V0KGNoYW5uZWxOYW1lKTtcclxuICAgICAgaWYgKGN1cnJlbnRMaXN0ZW5lciA9PT0gc3VicykgdGhpcy5yZXF1ZXN0TGlzdGVuZXJzLmRlbGV0ZShjaGFubmVsTmFtZSk7XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGN1cnJlbnRMaXN0ZW5lciA9IHRoaXMucmVxdWVzdExpc3RlbmVycy5nZXQoY2hhbm5lbE5hbWUpO1xyXG4gICAgaWYgKGN1cnJlbnRMaXN0ZW5lcikge1xyXG4gICAgICBjdXJyZW50TGlzdGVuZXIuaXNEaXNwb3NlZCA9IHRydWU7XHJcbiAgICAgIGNvbnNvbGUud2FybihcIlJlcXVlc3QgbGlzdGVuZXIgcmVwbGFjZWQ6IFwiICsgY2hhbm5lbE5hbWUpO1xyXG4gICAgfVxyXG4gICAgdGhpcy5yZXF1ZXN0TGlzdGVuZXJzLnNldChjaGFubmVsTmFtZSwgc3Vicyk7XHJcbiAgICByZXR1cm4gc3VicztcclxuICB9XHJcblxyXG4gIHByaXZhdGUgcmVxdWVzdExpc3RlbmVycyA9IG5ldyBNYXA8c3RyaW5nLCBSZXFTdWJzY3JpcHRpb24+KCk7XHJcblxyXG4gIHByaXZhdGUgYXN5bmMgX19ub3RpZnlTdWJzY3JpYmVycyhcclxuICAgIHN1YnNLZXk6IHN0cmluZyxcclxuICAgIG1zZzogdW5rbm93bixcclxuICAgIHNJZDogc3RyaW5nXHJcbiAgKSB7XHJcbiAgICBjb25zdCBoYW5kbGVycyA9IHRoaXMuc3Vic2NyaWJlcnMuZ2V0KHN1YnNLZXkpIHx8IFtdO1xyXG5cclxuICAgIGNvbnN0IGFsbFN1YnNjcmliZXJzUHJvbWlzZXM6IFByb21pc2U8dm9pZD5bXSA9IFtdO1xyXG4gICAgZm9yIChjb25zdCBoIG9mIGhhbmRsZXJzKSB7XHJcbiAgICAgIGlmICghaCkgY29udGludWU7XHJcbiAgICAgIGFsbFN1YnNjcmliZXJzUHJvbWlzZXMucHVzaChQcm9taXNlLnJlc29sdmUoaChtc2csIHNJZCkpKTtcclxuICAgICAgaWYgKHRoaXMudHJhY2UpIGNvbnNvbGUubG9nKFwiW0hhbmRsZXIgY2FsbGVkXVwiLCBoLCB0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBhd2FpdCBQcm9taXNlLmFsbChhbGxTdWJzY3JpYmVyc1Byb21pc2VzKTtcclxuXHJcbiAgICBpZiAodGhpcy5zdGF0ZS5oYXMoc3Vic0tleSkpIHRoaXMuc3RhdGUuc2V0KHN1YnNLZXksIG1zZyk7XHJcblxyXG4gICAgdGhpcy5fX2hhbmRsZUF3YWl0ZXIoc3Vic0tleSwgbXNnKTtcclxuXHJcbiAgICBpZiAodGhpcy50cmFjZSkgY29uc29sZS5sb2coXCJbTWVzc2FnZSBoYW5kbGVkXVwiLCBzdWJzS2V5LCBtc2csIHRoaXMpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBfX2hhbmRsZUF3YWl0ZXIoc3Vic0tleTogc3RyaW5nLCBtc2c6IHVua25vd24pIHtcclxuICAgIGNvbnN0IGF3YWl0ZXIgPSB0aGlzLl9fbmV4dE1lc3NhZ2VBd2F0ZXJzLmdldChzdWJzS2V5KTtcclxuICAgIGlmICghYXdhaXRlcikgcmV0dXJuO1xyXG5cclxuICAgIGF3YWl0ZXIucmVzb2x2ZShtc2cpO1xyXG5cclxuICAgIHRoaXMuX19uZXh0TWVzc2FnZUF3YXRlcnMuZGVsZXRlKHN1YnNLZXkpO1xyXG4gIH1cclxufVxyXG5cclxuZ2xvYmFsVGhpcy5Ccm93c2VyTWVzc2FnZUJyb2tlciA9XHJcbiAgZ2xvYmFsVGhpcy5Ccm93c2VyTWVzc2FnZUJyb2tlciB8fCBuZXcgQnJva2VyKCk7XHJcblxyXG5leHBvcnQgY29uc3QgQk1CID0gZ2xvYmFsVGhpcy5Ccm93c2VyTWVzc2FnZUJyb2tlcjtcclxuZXhwb3J0IHR5cGUgeyBJQnJva2VyLCBTdWJzY3JpcHRpb24gfSBmcm9tIFwiLi9UeXBlc1wiO1xyXG4iLCAiZXhwb3J0IGNvbnN0IFBVQl9TVUJfUkVRVUVTVF9TVUJTQ1JJUFRJT05fS0VZID0gXCJ0ZXN0UmVxXCI7XHJcbmV4cG9ydCBjb25zdCBQVUJfU1VCX1JFU1BPTlNFX1NVQlNDUklQVElPTl9LRVkgPSBcInRlc3RSZXNwXCI7XHJcbmV4cG9ydCBjb25zdCBSRVFfUkVQX0NIQU5ORUxfTkFNRSA9IFwicmVxUmVwQ2hhbm5lbFwiO1xyXG4iLCAiaW1wb3J0IHsgQk1CIH0gZnJvbSBcImJyb3dzZXItbWVzc2FnZS1icm9rZXJcIjtcclxuaW1wb3J0IHtcclxuICBQVUJfU1VCX1JFUVVFU1RfU1VCU0NSSVBUSU9OX0tFWSxcclxuICBQVUJfU1VCX1JFU1BPTlNFX1NVQlNDUklQVElPTl9LRVksXHJcbiAgUkVRX1JFUF9DSEFOTkVMX05BTUUsXHJcbn0gZnJvbSBcIi4vY29uc3RhbnRzXCI7XHJcblxyXG5jb25zdCBwdWJTdWJDaGFubmVsVG9XaW5kb3cgPSBCTUIuU3Vic2NyaWJlKFxyXG4gIFBVQl9TVUJfUkVTUE9OU0VfU1VCU0NSSVBUSU9OX0tFWSxcclxuICB1bmRlZmluZWQsXHJcbiAgdHJ1ZVxyXG4pO1xyXG5cclxuQk1CLlN1YnNjcmliZShcclxuICBQVUJfU1VCX1JFUVVFU1RfU1VCU0NSSVBUSU9OX0tFWSxcclxuICAoXykgPT4ge1xyXG4gICAgcHViU3ViQ2hhbm5lbFRvV2luZG93LnB1Ymxpc2goeyBwYXlsb2FkOiBcInJlc3BvbnNlXCIgfSk7XHJcbiAgfSxcclxuICB0cnVlXHJcbik7XHJcblxyXG5CTUIuUmVwbHkoXHJcbiAgUkVRX1JFUF9DSEFOTkVMX05BTUUsXHJcbiAgKHJlcTogeyBwYXlsb2FkOiBzdHJpbmcgfSkgPT4ge1xyXG4gICAgcmV0dXJuIHsgcGF5bG9hZDogcmVxLnBheWxvYWQgKyBcInJlc3BvbnNlXCIgfTtcclxuICB9LFxyXG4gIHRydWVcclxuKTtcclxuXHJcbi8vbGV0IHdpbmRvdyBrbm93IHRoYXQgd29ya2VyIGlzIHJlYWR5IGFuZCBleGVjdXRlIHRlc3RcclxucG9zdE1lc3NhZ2UoXCJyZWFkeVwiKTtcclxuIl0sCiAgIm1hcHBpbmdzIjogIjtBQVdBLElBQU0sSUFBaUI7QUFB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
